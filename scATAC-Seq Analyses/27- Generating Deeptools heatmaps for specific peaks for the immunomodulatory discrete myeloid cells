######### Specific peaks that are used as input for the -R option in computeMatrix are identified in the normalized pseudo-bulked peaks file. We converted the log1p values to exponential values and considered a peak to be specific to a particular discrete annotation if it had a count at least 2.5 times higher than the average counts of the other annotations.

computeMatrix reference-point -S ../sorted_Discrete_Fragments/Monocyte-TileSize-50-normMethod-nCount_peaks_macs2.bw ../sorted_Discrete_Fragments/Systemic-TileSize-50-normMethod-nCount_peaks_macs2.bw ../sorted_Discrete_Fragments/Scavenger-TileSize-50-normMethod-nCount_peaks_macs2.bw ../sorted_Discrete_Fragments/Complement-TileSize-50-normMethod-nCount_peaks_macs2.bw ../sorted_Discrete_Fragments/Tissue_resident-TileSize-50-normMethod-nCount_peaks_macs2.bw ../sorted_Discrete_Fragments/Microglia-TileSize-50-normMethod-nCount_peaks_macs2.bw -R Monocytes_Specific.bed Systemic_Specific.bed Scavenger_Specific.bed Complement_Specific.bed Tissue_Resident_Specific.bed Microglia_Specific.bed -b 1000 -a 1000 --skipZeros --smartLabels -o Ding_Discrete_Supervised_Specific_Peaks_Centered_Signac_Normalized_Version4_ArchR.gz --referencePoint center;

plotHeatmap -m Ding_Discrete_Supervised_Specific_Peaks_Centered_Signac_Normalized_Version4_ArchR.gz -o Ding_Discrete_Supervised_Specific_Peaks_Centered_Signac_Normalized_Version4_ArchR.pdf --startLabel 5 --endLabel 3 --whatToShow "heatmap and colorbar" --colorMap Blues --outFileSortedRegions Ding_Discrete_Supervised_Specific_Peaks_Centered_Signac_Normalized_Version4_ArchR.bed;
